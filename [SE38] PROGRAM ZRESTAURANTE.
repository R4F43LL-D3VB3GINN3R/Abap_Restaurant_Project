PROGRAM Z001.

"TABELA DE DADOS DOS FUNCIONÁRIOS"
"----------------------------------------------------------------------

"                [TABELA TRANSPARENTE: ZRESTEMPLOYEE]                 "

"ID_GERENTE       TYPE ZIDGER CHAVE PRIMÁRIA    -> ID
"ID_SAL_FK        TYPE ZIDGER CHAVE ESTRANGEIRA -> ID_SALARIO
"CARGO            TYPE ZGERENTE                 -> CARGO
"FUNCIONARIO      TYPE ZFUNCIONARIO             -> NOME
"DATA_CONTRATACAO TYPE ZDATACONTR               -> DATA DA CONTRATAÇÃO
"TURNO            TYPE ZTURNO                   -> TURNO
"SEXO             TYPE ZSEXF                    -> SEXO
"IDADE            TYPE ZIDADEF                  -> IDADE
"ORDENADO         TYPE ZORDENADO                -> ORDENADO OU SALÁRIO
"PAGAMENTO        TYPE ZPAGAMENTO               -> STATUS DO PAGAMENTO

"----------------------------------------------------------------------
"TABELA DE DADOS DOS PAGAMENTOS E TRIBUTAÇÕES"
"----------------------------------------------------------------------

"                  [TABELA TRANSPARENTE: ZRESTSAL]                    "

"ID               TYPE ZIDGER CHAVE PRIMÁRIA -> ID
"SALBRUTO         TYPE ZSALBRUTO             -> SALÁRIO BRUTO
"SALIQUIDO        TYPE ZSALIQUIDO            -> SALÁRIO LÍQUIDO
"PLANSAUDE        TYPE ZPLANSAUDE            -> PLANO DE SAÚDE
"CSINDICAL        TYPE ZSINDICAL             -> CONTRIBUIÇÃO SINDICAL
"VALETRANS        TYPE ZVALETRANS            -> VALETRANSPORTE
"HORAEXTRA        TYPE ZHORAEXTRA            -> HORAS EXTRAS
"DEDUCOES         TYPE ZDEDUCOES             -> DEDUÇÕES SALARIAIS
"SEGOSOCIAL       TYPE ZSEGSOCIAL            -> SEGURANÇA SOCIAL
"IRS              TYPE ZIRS                  -> IRS
"BONUS            TYPE ZBONUS                -> BÔNUS SALARIAL
"SUBDECFER        TYPE ZSUBDECFER            -> SUBSÍDIO FÉRIAS & DÉCIMO
"SUBDP            TYPE ZSUBDP                -> SUBTRAÇÃO DE PRESENÇAS

"----------------------------------------------------------------------
"TABELA DE EX-FUNCIONÁRIOS"
"----------------------------------------------------------------------

"                [TABELA TRANSPARENTE: ZRESTEXC]                      "

"ID               TYPE ZIDGER CHAVE PRIMÁRIA    -> ID
"CARGO            TYPE ZGERENTE                 -> CARGO
"FUNCIONARIO      TYPE ZFUNCIONARIO             -> NOME
"DATA_CONTRATACAO TYPE ZDATACONTR               -> DATA DA CONTRATAÇÃO
"ORDENADO         TYPE ZORDENADO                -> ORDENADO OU SALÁRIO

"----------------------------------------------------------------------

TYPES: WA_EMP TYPE ZRESTEMPLOYEE,         "ESTRUTURA GLOBAL DO TIPO DA MINHA TABELA TRANSPARENTE."
       WA_SAL TYPE ZRESTSAL,              "ESTRUTURA GLOBAL DO TIPO DA MINHA TABELA TRANSPARENTE."
       WA_EXC TYPE ZRESTEXC.              "ESTRUTURA GLOBAL DO TIPO DA MINHA TABELA TRANSPARENTE."

DATA: LS_EMP TYPE WA_EMP,                 "ESTRUTURA LOCAL DO TIPO DA MINHA ESTRUTURA GLOBAL."
      LS_SAL TYPE WA_SAL,                 "ESTRUTURA LOCAL DO TIPO DA MINHA ESTRUTURA GLOBAL."
      LS_EXC TYPE WA_EXC,                 "ESTRUTURA LOCAL DO TIPO DA MINHA ESTRUTURA GLOBAL."

      LT_EMP TYPE TABLE OF ZRESTEMPLOYEE, "TABELA INTERNA DO TIPO DA MINHA TABELA TRANSPARENTE."
      LT_SAL TYPE TABLE OF ZRESTSAL,      "TABELA INTERNA DO TIPO DA MINHA TABELA TRANSPARENTE."
      LT_EXC TYPE TABLE OF ZRESTEXC.      "TABELA INTERNA DO TIPO DA MINHA TABELA TRANSPARENTE."

DATA: REPORTALV TYPE REF TO CL_SALV_TABLE,     "VARIÁVEL QUE FAZ REFERÊNCIA AO OBJETO DA CLASSE CL_SALV_TABLE."
      FUNCTIONS TYPE REF TO CL_SALV_FUNCTIONS. "VARIÁVEL QUE VAI ARMAZENAR A REFERÊNCIA AO OBJETO DA CLASSE CL_SALV_FUNCTIONS."

DATA: OKCODE_100 TYPE SY-UCOMM, "VARIÁVEL DO TIPO COMANDO DE FUNÇÃO DYNPRO PARA TELA 100."
      OKCODE_200 TYPE SY-UCOMM, "VARIÁVEL DO TIPO COMANDO DE FUNÇÃO DYNPRO PARA TELA 200."
      OKCODE_300 TYPE SY-UCOMM, "VARIÁVEL DO TIPO COMANDO DE FUNÇÃO DYNPRO PARA TELA 300."
      OKCODE_400 TYPE SY-UCOMM, "VARIÁVEL DO TIPO COMANDO DE FUNÇÃO DYNPRO PARA TELA 400."
      OKCODE_500 TYPE SY-UCOMM, "VARIÁVEL DO TIPO COMANDO DE FUNÇÃO DYNPRO PARA TELA 500."
      OKCODE_600 TYPE SY-UCOMM. "VARIÁVEL DO TIPO COMANDO DE FUNÇÃO DYNPRO PARA TELA 600."

"----------------------------------------------------------------------

*&---------------------------------------------------------------------*
*& Module ANTES_DO_LOGIN_0100 OUTPUT
*&---------------------------------------------------------------------*
*& "TELA DE LOGIN"
*&---------------------------------------------------------------------*
MODULE ANTES_DO_LOGIN_0100 OUTPUT.

* SET PF-STATUS 'xxxxxxxx'.
* SET TITLEBAR 'xxx'.

  DATA:
    IN1      TYPE C LENGTH 10, "LOGIN DO PROGRAMA NA TELA 100
    IN2      TYPE C LENGTH 10, "SENHA DO PROGRAMA NA TELA 100
    CONTADOR TYPE INT1.        "CONTADOR PARA CONTAR O NÚMERO DE ERROS PERMITIDOS AO TENTAR LOGAR."

ENDMODULE.

*&---------------------------------------------------------------------*
*&      Module  DEPOIS_DO_LOGIN_0100  INPUT
*&---------------------------------------------------------------------*
*& "TELA DE LOGIN"
*----------------------------------------------------------------------*
MODULE DEPOIS_DO_LOGIN_0100 INPUT.

  CASE OKCODE_100.                         "EM CASO DE OKCODE_100...
    WHEN 'FCT_ENTRAR'.                     "E QUANDO O BOTÃO ENTRAR FOR PRESSIONADO...
      CONTADOR = CONTADOR + 1.             "O CONTADOR COMEÇA A CONTAR."
      IF IN1 EQ 'ADMIN0' AND IN2 EQ '000'. "E SE O LOGIN FOR IGUAL A ADMIN0 JUNTAMENTE COM A SENHA IGUAL A 000...
        CALL SCREEN '200'.                 "IR PARA A TELA 100.
      ELSE.                                "DO CONTRÁRIO...
        IF CONTADOR >= 3.                  "SE O CONTADOR FOR MAIOR QUE 3...
          LEAVE PROGRAM.                   "SAIR DO PPROGRAMA."
        ELSE.                              "DO CONTRÁRIO...

          MESSAGE |COMBINAÇÃO INVÁLIDA: { 3 - CONTADOR }]| TYPE 'S' DISPLAY LIKE 'I'. "EXIBIR MENSAGEM E UMA CONTAGEM REGRESSIVA DE POSSIBILIDADES DE TENTATIVAS."
        ENDIF.
      ENDIF.
    WHEN 'FCT_SAIR'.                       "E QUANDO O BOTÃO SAIR FOR PRESSIONADO...
      LEAVE PROGRAM.                       "SAIR DO PROGRAMA.
  ENDCASE.

ENDMODULE.

*&---------------------------------------------------------------------*
*& Module ANTES_DE_SELECIONAR OUTPUT
*&---------------------------------------------------------------------*
*& "MENU DE OPÇÕES"
*&---------------------------------------------------------------------*
MODULE ANTES_DE_SELECIONAR OUTPUT.
* SET PF-STATUS 'xxxxxxxx'.
* SET TITLEBAR 'xxx'.

ENDMODULE.


*&---------------------------------------------------------------------*
*&      Module  DEPOIS_DE_SELECIONAR  INPUT
*&---------------------------------------------------------------------*
* "MENU DE OPÇÕES"
*----------------------------------------------------------------------*
MODULE DEPOIS_DE_SELECIONAR INPUT.

  CASE OKCODE_200.         "EM CASO DE OKCODE_200...
    WHEN 'FCT_SAIR2'.      "E QUANDO O BOTÃO SAIR FOR PRESSIONADO...
      LEAVE PROGRAM.       "SAIR DO PROGRAMA."
    WHEN 'FCT_CADASTRAR2'. "E QUANDO O BOTÃO CADASTRAR FOR PRESSIONADO...
      CALL SCREEN '300'.   "IR PARA A TELA 300."
    WHEN 'FCT_PAGAR2'.     "E QUANDO O BOTÃO PAGAR FOR PRESSIONADO...
      CALL SCREEN '500'.   "IR PARA A TELA 500."
    WHEN 'FCT_CONSULTAR2'. "E QUANDO O BOTÃO CONSULTAR FOR PRESSIONADO...
      CALL SCREEN '400'.   "IR PARA A TELA 400."
    WHEN 'FCT_REMOVER2'.   "E QUANDO O BOTÃO REMOVER FOR PRESSIONADO...
      CALL SCREEN '600'.   "IR PARA A TELA 600."
  ENDCASE.

ENDMODULE.

*&---------------------------------------------------------------------*
*& Module ANTES_DO_CADASTRO_300 OUTPUT
*&---------------------------------------------------------------------*
*& "TELA DE CADASTRO DE FUNCIONÁRIO"
*&---------------------------------------------------------------------*
MODULE ANTES_DO_CADASTRO_300 OUTPUT.
* SET PF-STATUS 'xxxxxxxx'.
* SET TITLEBAR 'xxx'.

  "TODOS OS INPUTS DA TELA 300 RECEBEM O MESMO TIPO DE ELEMENTO DE DADOS DA MINHA TABELA TRANSPARENTE."

  DATA: IN0_3  TYPE ZIDGER,        "ID"
        IN1_3  TYPE ZGERENTE,      "CARGO"
        IN2_3  TYPE ZFUNCIONARIO,  "NOME"
        IN3_3  TYPE ZDATACONTR,    "DATA"
        IN31_3 TYPE ZTURNO,        "TURNO
        IN4_3  TYPE ZSEXF,         "SEXO"
        IN5_3  TYPE ZIDADEF,       "IDADE"
        IN6_3  TYPE ZORDENADO,     "ORDENADO"
        IN7_3  TYPE ZDESCR.        "OBSERVAÇÕES"

ENDMODULE.

*&---------------------------------------------------------------------*
*&      Module  DEPOIS_DE_CADASTRAR_300  INPUT
*&---------------------------------------------------------------------*
* "TELA DE CADASTRO DE FUNCIONÁRIO"
*----------------------------------------------------------------------*
MODULE DEPOIS_DE_CADASTRAR_300 INPUT.

  CASE OKCODE_300.         "EM CASO DE OKCODE_300...
    WHEN 'FCT_SAIR3'.      "E QUANDO O BOTÃO SAIR FOR PRESSIONADO...
      LEAVE PROGRAM.       "SAIR DO PROGRAMA.
    WHEN 'FCT_VOLTAR3'.    "E QUANDO O BOTÃO VOLTAR FOR PRESSIONADO...
      CALL SCREEN '200'.   "IR PARA A TELA 200.
    WHEN 'FCT_CADASTRAR3'. "E QUANDO O BOTÃO CADASTRAR FOR PRESSIONADO...

      "É FUNDAMENTAL USAR O ID_GERENTE NA INSERÇÃO DE DADOS ÀS TABELAS TRANSPARENTES...
      "...POIS O ID DIFERENTE FAZ COM QUE O COMANDO MODIFY NÃO INSIRA DADOS EM CIMA DA MESMA LINHA RECÉM CRIADA."

      LS_EMP-ID_GERENTE = IN0_3.       "ID DA MINHA ESTRUTURA RECEBE O ID DA TELA 300"
      LS_EMP-CARGO = IN1_3.            "CARGO DA MINHA ESTRUTURA RECEBE O CARGO DA TELA 300."
      LS_EMP-FUNCIONARIO = IN2_3.      "FUNCIONARIO DA MINHA ESTRUTURA RECEBE O FUNCIIONARIO DA TELA 300."
      LS_EMP-DATA_CONTRATACAO = IN3_3. "DATA DE CONTRATACAO DA MINHA ESTRUTURA RECEBE A DATA DA TELA 300."
      LS_EMP-TURNO = IN31_3.           "TURNO DE CONTRATAÇÃO DA MINHA ESTRUTURA RECEBE O TURNO DA TELA 300."
      LS_EMP-SEXO = IN4_3.             "SEXO DA MINHA ESTRUTURA RECEBE O SEXO DA TELA 300."
      LS_EMP-IDADE = IN5_3.            "IDADE DA MINHA ESTRUTURA RECEBE A IDADE DA TELA 300."
      LS_EMP-ORDENADO = IN6_3.         "ORDENADO DA MINHA ESTRUTURA RECEBE O ORDENADO DA TELA 300."

      APPEND LS_EMP TO LT_EMP.                "INSERIR A MINHA ESTRUTURA NA MINHA TABELA INTERNA."
      MODIFY ZRESTEMPLOYEE FROM TABLE LT_EMP. "INSERIR O CONTEÚDO DA MINHA TABELA INTERNA PARA A TABELA TRANSPARENTE."

  ENDCASE.

ENDMODULE.

*&---------------------------------------------------------------------*
*& Module ANTES_DO_PAGAMENTO_500 OUTPUT
*&---------------------------------------------------------------------*
*& "TELA DE PAGAMENTO DE FUNCIONÁRIO"
*&---------------------------------------------------------------------*
MODULE ANTES_DO_PAGAMENTO_500 OUTPUT.
* SET PF-STATUS 'xxxxxxxx'.
* SET TITLEBAR 'xxx'.

  "O INPUT ID E PAGAMENTO DA TELA 500 RECEBE O MESMO TIPO DE ELEMENTO DE DADOS DA MINHA TABELA TRANSPARENTE."

  DATA: IN1_5 TYPE ZIDGER,     "ID"
        IN2_5 TYPE ZPAGAMENTO. "PAGAMENTO"

ENDMODULE.

*&---------------------------------------------------------------------*
*&      Module  DEPOIS_DO_PAGAMENTO_0500  INPUT
*&---------------------------------------------------------------------*
* "TELA DE PAGAMENTO DE FUNCIONÁRIO"
*----------------------------------------------------------------------*
MODULE DEPOIS_DO_PAGAMENTO_0500 INPUT.

  CASE OKCODE_500.       "EM CASO DE OKCODE_500...
    WHEN 'FCT_VOLTAR5'.  "E QUANDO O BOTÃO VOLTAR FOR PRESSIONADO...
      CALL SCREEN '200'. "IR PARA A TELA 200."
    WHEN 'FCT_SAIR5'.    "E QUANDO O BOTÃO SAIR FOR PRESSIONADO...
      LEAVE PROGRAM.     "SAIR DO PROGRAMA."
    WHEN 'FCT_DEFINIR5'. "E QUANDO O BOTÃO DEFINIR FOR PRESSIONADO...

      "PARA QUE O BOTÃO DEFINIR TENHA A SUA FUNCIONALIDADE, O CAMPO ID E A FORMA DE PAGAMENTO DEVEM ESTAR PREENCHIDOS."

      LS_EMP-ID_GERENTE = IN1_5. "ID DA MINHA ESTRUTURA RECEBE O ID DA TELA 500"
      LS_EMP-PAGAMENTO = IN2_5.  "PAGAMENTO DA MINHA ESTRUTURA RECEBE O PAGAMENTO DA TELA 500".

      APPEND LS_EMP TO LT_EMP. "INSIRA MINHA ESTRUTURA NA TABELA LOCAL À MINHA TABELA INTERNA"

      UPDATE ZRESTEMPLOYEE SET PAGAMENTO = LS_EMP-PAGAMENTO WHERE ID_GERENTE = IN1_5.
      "ATUALIZE A MINHA TABELA TRANSPARENTE SUBSTITUINDO A COLUNA PAGAMENTO PELO PAGAMENTO DE MINHA ESTRUTURA...
      "ONDE O ID DO GERENTE DE MINHA TABELA FOR IGUAL AO INPUT DA TELA 500."

    WHEN 'FCT_PAGOS5'. "E QUANDO O BOTÃO PAGOS FOR PRESSIONADO...

      SELECT FUNCIONARIO, PAGAMENTO FROM ZRESTEMPLOYEE INTO TABLE @DATA(LT_PAGOS) WHERE PAGAMENTO = 'OK'.
      "SELECIONE AS COLUNAS FUNCIONARIO E PAGAMENTO DA TABELA ZRESTEMPLOYEE E INSIRA NA TABELA LT_PAGOS ONDE PAGAMENTO RECEBE 'OK'."

      TRY.                                                                  "TENTE
          CALL METHOD CL_SALV_TABLE=>FACTORY                                "CHAMADA DO MÉTODO DA CLASSE DE MANIPULAÇÃOO ALV PARA EXIBIR O RELATÓRIO."
            IMPORTING
              R_SALV_TABLE = REPORTALV                                      "A VARIÁVEL DE REFERÊNCIA À CLASSE CL_SALV_TABLE É IMPORTADA."
            CHANGING
              T_TABLE      = LT_PAGOS.                                      "MINHA TABELA INTERNA É ALTERADA COM A CLÁUSULA CHANGING DO MÉTODO."

          FUNCTIONS = REPORTALV->GET_FUNCTIONS( ).                          "OBTER AS FUNÇÕES DISPONÍVEIS PARA O RELATÓRIO ALV."
          FUNCTIONS->SET_ALL( ABAP_TRUE ).                                  "QUE TODAS AS FUNÇÕES ESTEJAM DISPONÍVEIS."

          CALL METHOD REPORTALV->DISPLAY( ).                                "CHAMADA DO MÉTODO PARA EXIBIR O RELATÓRIO ALV."
        CATCH CX_SALV_MSG.                                                  "CASO HAJA ALGUM PROBLEMA, SUBSTITUA O TRECHO ANTERIOR DO CÓDIGO POR...
          MESSAGE 'ERROR TO DISPLAY ALV REPORT!' TYPE 'S' DISPLAY LIKE 'I'. "...UMA MENSAGEM DE ERRO"
      ENDTRY.

    WHEN 'FCT_NPAGOS5'.

      SELECT FUNCIONARIO, PAGAMENTO FROM ZRESTEMPLOYEE INTO TABLE @DATA(LT_NPAGOS) WHERE PAGAMENTO = 'PENDENTE'.
      "SELECIONE AS COLUNAS FUNCIONARIO E PAGAMENTO DA TABELA ZRESTEMPLOYEE E INSIRA NA TABELA LT_PAGOS ONDE PAGAMENTO RECEBE 'OK'."

      TRY.                                                                  "TENTE
          CALL METHOD CL_SALV_TABLE=>FACTORY                                "CHAMADA DO MÉTODO DA CLASSE DE MANIPULAÇÃOO ALV PARA EXIBIR O RELATÓRIO."
            IMPORTING
              R_SALV_TABLE = REPORTALV                                      "A VARIÁVEL DE REFERÊNCIA À CLASSE CL_SALV_TABLE É IMPORTADA."
            CHANGING
              T_TABLE      = LT_NPAGOS.                                     "MINHA TABELA INTERNA É ALTERADA COM A CLÁUSULA CHANGING DO MÉTODO."

          FUNCTIONS = REPORTALV->GET_FUNCTIONS( ).                          "OBTER AS FUNÇÕES DISPONÍVEIS PARA O RELATÓRIO ALV."
          FUNCTIONS->SET_ALL( ABAP_TRUE ).                                  "QUE TODAS AS FUNÇÕES ESTEJAM DISPONÍVEIS."

          CALL METHOD REPORTALV->DISPLAY( ).                                "CHAMADA DO MÉTODO PARA EXIBIR O RELATÓRIO ALV."
        CATCH CX_SALV_MSG.                                                  "CASO HAJA ALGUM PROBLEMA, SUBSTITUA O TRECHO ANTERIOR DO CÓDIGO POR...
          MESSAGE 'ERROR TO DISPLAY ALV REPORT!' TYPE 'S' DISPLAY LIKE 'I'. "...UMA MENSAGEM DE ERRO"
      ENDTRY.

  ENDCASE.

ENDMODULE.

*&---------------------------------------------------------------------*
*& Module ANTES_DA_CONSULTA_400 OUTPUT
*&---------------------------------------------------------------------*
*& "TELA DE CONSULTA DE RELATÓRIOS"
*&---------------------------------------------------------------------*
MODULE ANTES_DA_CONSULTA_400 OUTPUT.
* SET PF-STATUS 'xxxxxxxx'.
* SET TITLEBAR 'xxx'.

  "TODOS OS INPUTS E CHECKBOXES DA TELA 300 RECEBEM O MESMO TIPO DE ELEMENTO DE DADOS DA MINHA TABELA TRANSPARENTE."

  DATA: IN1_4 TYPE ZIDGER,     "ID"
        CB1_4 TYPE ZPLANSAUDE, "PLANO DE SAÚDE"
        CB2_4 TYPE ZSINDICAL,  "CONTRIBUIÇÃO SINDICAL"
        CB3_4 TYPE ZVALETRANS, "VALE TRANSPORTE"
        IN2_4 TYPE ZHORAEXTRA, "HORAS EXTRAS"
        IN5_4 TYPE ZSUBDECFER, "SUBSÍDIO FÉRIAS E DÉCIMO TERCEIRO"
        IN3_4 TYPE ZSUBDP,     "FALTAS"
        IN4_4 TYPE ZSUBDP.     "ATRASOS"

ENDMODULE.

*&---------------------------------------------------------------------*
*&      Module  DEPOIS_DA_CONSULTA_400  INPUT
*&---------------------------------------------------------------------*
* "TELA DE CONSULTA DE RELATÓRIOS"
*----------------------------------------------------------------------*
MODULE DEPOIS_DA_CONSULTA_400 INPUT.

  CASE OKCODE_400.       "EM CASO DE OKCODE_300...
    WHEN 'FCT_VOLTAR4'.  "E QUANDO O BOTÃO SAIR FOR PRESSIONADO...
      CALL SCREEN '200'. "IR PARA A TELA 200."
    WHEN 'FCT_SAIR4'.    "E QUANDO O BOTÃO SAIR FOR PRESSIONADO...
      LEAVE PROGRAM.     "SAIR DO PROGRAMA."
    WHEN 'FCT_INSERIR4'. "E QUANDO O BOTÃO SAIR FOR PRESSIONADO...

      FREE LS_SAL. "LIMPAR ESTRUTURA"

      CLEAR LT_SAL. "LIMPAR TABELA INTERNA"

      LS_SAL-ID = IN1_4. "O ID DA MINHA ESTRUTURA RECEBE O ID DO INPUT."

      SELECT SINGLE ORDENADO FROM ZRESTEMPLOYEE INTO @DATA(LV_ORDENADO) WHERE ID_GERENTE = @IN1_4.
      "SELECIONE APENAS UM DADO DA COLUNA ORDENADO DA TABELA TRANSPARENTE ZRESTEMPLOYEE...
      "DENTRO DA VARIÁVEL CRIADA AGORA LV_ORDENADO...
      "ONDE O ID_GERENTE FOR IGUAL AO INPUT DA TELA 400."

      "--------------------------"
      "--------------------------"
      "    TURNO DE TRABALHO     "
      "--------------------------"
      "--------------------------"

      "VAMOS CUIDAR PARA QUE O TRABALHADOR NOTURNO RECEBA O SEU ADICIONAL NOTURNO"

      SELECT SINGLE TURNO FROM ZRESTEMPLOYEE INTO @DATA(LV_TURNO) WHERE ID_GERENTE = @IN1_4.
      "SELECIONE APENAS UM DADO DA COLUNA TURNO DA TABELA TRANSPARENTE ZRESTEMPLOYEE...
      "DENTRO DA VARIÁVEL CRIADA AGORA LV_TURNO...
      "ONDE O ID_GERENTE FOR IGUAL AO INPUT DA TELA 400."

      IF LV_TURNO = 'NOTURNO'.                                   "SE O TURNO DO EMPREGADO FOR NOTURNO"
        LS_SAL-BONUS = LS_SAL-BONUS + ( '0.25' * LV_ORDENADO ).  "A VARIÁVEL BÔNUS DE MINHA ESTRUTURA RECEBE MAIS 25% DO ORDENADO"
      ELSE.                                                      "DO CONTRÁRIO...
        LS_SAL-BONUS = 0.                                        "A VARIÁVEL BÔNUS DE MINHA ESTRUTURA RECEBE ZERO"
      ENDIF.

      "--------------------------"
      "--------------------------"
      "      HORAS EXTRAS        "
      "--------------------------"
      "--------------------------"

      "AQUI VAMOS CALCULAR COMO O VALOR DAS HORAS EXTRAS VAI SE COMPORTAR DE ACORDO COM O TURNO TRABALHADO"

      DATA: LV_VALHRS TYPE ZSUBDP. "CRIA-SE UMA VARIÁVEL QUE IRÁ RECEBER O VALOR DA HORA"

      LV_VALHRS = LV_ORDENADO / ( 8 * 22 ). "VALOR DA HORA = SALÁRIO BASE / ( 8 HORAS TRABALHADAS * 22 DIAS ÚTEIS DO MÊS).

      IF LV_TURNO = 'DIURNO'.            "SE FOR DURANTE O DIA...
        IN2_4 = IN2_4 * LV_VALHRS * 2.   "AS HORAS EXTRAS VALEM O DOBRO.
      ELSEIF LV_TURNO = 'NOTURNO'.       "SE FOR DURANTE A NOITE...
        IN2_4 = IN2_4 * LV_VALHRS * 3.   "AS HORAS EXTRAS VALEM O TRIPLO"
      ELSE.                              "EM QUALQUER OUTRO CASO...
        IN2_4 = IN2_4 * LV_VALHRS * 1.   "ELAS VALEM O QUE SÃO."
      ENDIF.

      "PARA SE CALCULAR O VALOR TOTAL DAS HORAS EXTRAS A RECEBER...
      "TOTAL DE HORAS EXTRAS = TOTAL DE HORAS EXTRAS * VALOR DA HORA DO FUNCIONÁRIO * TURNO TRABALHADO."

      LS_SAL-HORAEXTRA = IN2_4. "DIZEMOS ENTÃO QUE O VALOR TOTAL DAS HORAS EXTRAS EM MINHA ESTRUTURA RECEBE O RESULTADO CALCULADO DO PARÂMETRO."
      LS_SAL-SALBRUTO = LV_ORDENADO + LS_SAL-HORAEXTRA. "APROVEITAMOS E DIZEMOS QUE O SALÁRIO BRUTO RECEBE O SALÁRIO BASE + O VALOR DAS HORAS EXTRAS."

      "--------------------------"
      "--------------------------"
      "   SUBSÍDIO E DÉCIMO      "
      "--------------------------"
      "--------------------------"

      DATA: LV_YSDF TYPE ZSUBDP. "É CRIADA UMA VARIÁVEL LOCAL PARA RECEBER O VALOR DO SUBSÍDIO"

      IF IN5_4 = 'MENSAL'.                                                   "SE OPTAR POR RECEBER O SUBSÍDIO MENSALMENTE...
        LV_YSDF = LV_YSDF + ( LS_SAL-SALBRUTO / 12 ) + ( LV_ORDENADO / 12 ). "A VARIÁVEL LOCAL RECEBE O SUBSÍDIO FÉRIAS + SUBSÍDIO DÉCIMO TERCEIRO"
      ELSE.                                                                  "DO CONTRÁRIO...
        LV_YSDF = 0.                                                         "A VARIÁVEL RECEBE ZERO.
      ENDIF.

      "SE OPTAR POR RECEBER MENSALMENTE, O VALOR SERÁ ACRESCIDO AO SALÁRIO LÍQUIDO TODOS OS MESES."

      "--------------------------"
      "--------------------------"
      "       BENEFÍCIOS         "
      "--------------------------"
      "--------------------------"

      "DEPENDENDO DOS BENEFÍCIOS DE SERVIÇO QUE O TRABALHADOR OPTAR POR ESCOLHER, ESTES MESMOS SERÃO ACRESCENTADOS ÀS DEDUÇÕES SALARIAIS."

      IF CB1_4 = 'X'.                                                         "SE DECIDIR OPTAR POR UM PLANO DE SAÚDE PRIVADO...
        LS_SAL-PLANSAUDE = 'OK'.                                              "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR AUTORIZADO"
        LS_SAL-DEDUCOES = LS_SAL-DEDUCOES + ( ( 5 / 100 ) * LV_ORDENADO ).    "O PREÇO DO PRODUTO É ACRESCIDO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
      ELSE.                                                                   "DO CONTRÁRIO...
        LS_SAL-PLANSAUDE = 'NÃO'.                                             "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR NÃO AUTORIZADO"
      ENDIF.

      IF CB2_4 = 'X'.                                                         "SE DECIDIR OPTAR POR UMA CONTRIBUIÇÃO SINDICAL...
        LS_SAL-CSINDICAL = 'OK'.                                              "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR AUTORIZADO"
        LS_SAL-DEDUCOES = LS_SAL-DEDUCOES + 4.                                "O PREÇO DO PRODUTO É ACRESCIDO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
      ELSE.                                                                   "DO CONTRÁRIO...
        LS_SAL-CSINDICAL = 'NÃO'.                                             "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR NÃO AUTORIZADO"
      ENDIF.

      IF CB3_4 = 'X'.                                                         "SE DECIDIR OPTAR VALE TRANSPORTE...
        LS_SAL-VALETRANS = 'OK'.                                              "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR AUTORIZADO"
        LS_SAL-BONUS = LS_SAL-BONUS + '103.5'.                                "O PREÇO DO PRODUTO É ACRESCIDO À VARIÁVEL DE DEDUÇÕES SALARIAIS
      ELSE.                                                                   "DO CONTRÁRIO...
        LS_SAL-VALETRANS = 'NÃO'.                                             "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR NÃO AUTORIZADO"
      ENDIF.

      "DEPOIS DE TODOS OS SERVIÇOS OU NÃO, OS VALORES ESTARÃO SOMADOS E A VARIÁVEL LV_DEDUCT(DEDUÇÕES) RECEBERÁ ESTE VALOR.
      "OU A VARIÁVEL LV_BONUS RECEBERÁ UM ACRÉSCIMO EM SEU VALOR."

      "--------------------------"
      "--------------------------"
      "    SEGURANÇA SOCIAL      "
      "--------------------------"
      "--------------------------"

      IF LV_ORDENADO < 886.
        LS_SAL-DEDUCOES = LS_SAL-DEDUCOES + ( '0.11' * LV_ORDENADO ).
        LS_SAL-SEGSOCIAL = '0.11' * LV_ORDENADO.
      ELSEIF LV_ORDENADO => 886 AND LV_ORDENADO < 932.
        LS_SAL-DEDUCOES = LS_SAL-DEDUCOES + ( '0.11' * LV_ORDENADO ) + ( '0.06' * LV_ORDENADO ).
        LS_SAL-SEGSOCIAL = '0.11' * LV_ORDENADO.
        LS_SAL-IRS = ( '0.06' * LV_ORDENADO ).
      ELSEIF LV_ORDENADO => 932 AND LV_ORDENADO < 999.
        LS_SAL-DEDUCOES = LS_SAL-DEDUCOES + ( '0.11' * LV_ORDENADO ) + ( '0.08' * LV_ORDENADO ).
        LS_SAL-SEGSOCIAL = '0.11' * LV_ORDENADO.
        LS_SAL-IRS = ( '0.08' * LV_ORDENADO ).
      ELSEIF LV_ORDENADO => 999 AND LV_ORDENADO < 1106.
        LS_SAL-DEDUCOES = LS_SAL-DEDUCOES + ( '0.11' * LV_ORDENADO ) + ( '0.09' * LV_ORDENADO ).
        LS_SAL-SEGSOCIAL = '0.11' * LV_ORDENADO.
        LS_SAL-IRS = ( '0.09' * LV_ORDENADO ).
      ELSEIF LV_ORDENADO => 1106 AND LV_ORDENADO < 1600.
        LS_SAL-DEDUCOES = LS_SAL-DEDUCOES + ( '0.11' * LV_ORDENADO ) + ( '0.11' * LV_ORDENADO ).
        LS_SAL-SEGSOCIAL = '0.11' * LV_ORDENADO.
        LS_SAL-IRS = ( '0.11' * LV_ORDENADO ).
      ELSEIF LV_ORDENADO => 1600 AND LV_ORDENADO < 1961.
        LS_SAL-DEDUCOES = LS_SAL-DEDUCOES + ( '0.11' * LV_ORDENADO ) + ( '0.16' * LV_ORDENADO ).
        LS_SAL-SEGSOCIAL = '0.11' * LV_ORDENADO.
        LS_SAL-IRS = ( '0.16' * LV_ORDENADO ).
      ELSEIF LV_ORDENADO => 1961 AND LV_ORDENADO < 2529.
        LS_SAL-DEDUCOES = LS_SAL-DEDUCOES + ( '0.11' * LV_ORDENADO ) + ( '0.19' * LV_ORDENADO ).
        LS_SAL-SEGSOCIAL = '0.11' * LV_ORDENADO.
        LS_SAL-IRS = ( '0.19' * LV_ORDENADO ).
      ELSEIF LV_ORDENADO => 2529 AND LV_ORDENADO < 3694.
        LS_SAL-DEDUCOES = LS_SAL-DEDUCOES + ( '0.11' * LV_ORDENADO ) + ( '0.23' * LV_ORDENADO ).
        LS_SAL-SEGSOCIAL = '0.11' * LV_ORDENADO.
        LS_SAL-IRS = ( '0.23' * LV_ORDENADO ).
      ELSEIF LV_ORDENADO => 3694 AND LV_ORDENADO < 5469.
        LS_SAL-DEDUCOES = LS_SAL-DEDUCOES + ( '0.11' * LV_ORDENADO ) + ( '0.28' * LV_ORDENADO ).
        LS_SAL-SEGSOCIAL = '0.11' * LV_ORDENADO.
        LS_SAL-IRS = ( '0.28' * LV_ORDENADO ).
      ELSEIF LV_ORDENADO => 5469 AND LV_ORDENADO < 6420.
        LS_SAL-DEDUCOES = LS_SAL-DEDUCOES + ( '0.11' * LV_ORDENADO ) + ( '0.32' * LV_ORDENADO ).
        LS_SAL-SEGSOCIAL = '0.11' * LV_ORDENADO.
        LS_SAL-IRS = ( '0.32' * LV_ORDENADO ).
      ELSEIF LV_ORDENADO => 6420 AND LV_ORDENADO < 20064.
        LS_SAL-DEDUCOES = LS_SAL-DEDUCOES + ( '0.11' * LV_ORDENADO ) + ( '0.33' * LV_ORDENADO ).
        LS_SAL-SEGSOCIAL = '0.11' * LV_ORDENADO.
        LS_SAL-IRS = ( '0.33' * LV_ORDENADO ).
      ELSE.
        LS_SAL-DEDUCOES = LS_SAL-DEDUCOES + ( '0.11' * LV_ORDENADO ) + ( '0.41' * LV_ORDENADO ).
        LS_SAL-SEGSOCIAL = '0.011' * LV_ORDENADO.
        LS_SAL-IRS = ( '0.41' * LV_ORDENADO ).
      ENDIF.

      "SE SALÁRIO BASE FOR MAIOR QUE "VALOR" E MENOR QUE "VALOR..."
      "AS DEDUÇÕES RECEBEM O IMPOSTO DA SEGURANÇA SOCIAL E DO IRS."

      "--------------------------"
      "--------------------------"
      "        DESEMPENHO        "
      "--------------------------"
      "--------------------------"

      "CÁLCULO DE FALTAS E ATRASOS."

      DATA: LV_FALTAS  TYPE ZSUBDP, "UMA VARIÁVEL LOCAL PARA RECEBER O VALOR DAS FALTAS."
            LV_ATRASOS TYPE ZSUBDP. "UMA VARIÁVEL LOCAL PARA RECEBER O VALOR DOS ATRASOS."

      "ESTA ESTRUTURA CONDICIONAL FOI CRIADA APENAS PARA EVITAR UM VALOR DE 0, JÁ QUE VAMOS LIDAR COM UMA MULTIPLICAÇÃO."

      IF IN3_4 > 0.                                 "SE O VALOR DE ENTRADA FOR MAIOR DO QUE ZERO...
        LV_FALTAS = IN3_4 * ( LV_ORDENADO / 22 ).   "A VARIÁVEL DE FALTAS RECEBE O VALOR DO INPUT VEZES O ORDENADO / 22"
      ELSE.                                         "DO CONTRÁRIO...
        LV_FALTAS = 0.                              "A VARIÁVEL RECEBE ZERO."
      ENDIF.

      IF IN4_4 > 0.                                 "SE O VALOR DE ENTRADA FOR MAIOR DO QUE ZERO...
        LV_ATRASOS = IN4_4 * ( LV_ORDENADO / 176 ). "A VARIÁVEL DE ATRASOS RECEBE O VALOR DO INPUT VEZES O ORDENADO / 175"
      ELSE.                                         "DO CONTRÁRIO...
        LV_ATRASOS = 0.                             "A VARIÁVEL RECEBE ZERO."
      ENDIF.

      LS_SAL-SUBDP = LV_FALTAS + LV_ATRASOS.            "A VARIÁVEL SUBTRAÇÃO DE PRESENÇAS REECEBE O VALOR DE FALTAS + ATRASOS"
      LS_SAL-DEDUCOES = LS_SAL-DEDUCOES + LS_SAL-SUBDP. "ESTE VALOR É ADICIONADO AO VALOR DAS DEDUÇÕES SALARIAIS."

      "POR FIM, JÁ TEMOS TODOS OS VALORES E AS LÓGICAS POR DETRÁS DELES...MENOS UM.
      "NOSSO SALÁRIO LÍQUIDO, QUE É NOSSO SALÁRIO BRUTO MENOS TODAS AS DEDUÇÕES TRIBUTÁRIAS E SALARIAIS...
      "AS DEDUÇÕES TRIBUTÁRIAS SÓ PODERIAM SER CALCULADAS EM TOTALIDADE APÓS SABER QUANTO CADA EMPREGADOR TERÁ DE DECLARAR...
      "PARA A SEGURANÇA SOCIAL E QUANTIFICAR OS SERVIÇOS QUE O EMPREGADOR ADERIU."
      "SENDO ASSIM, PODEMOS ADMITIR QUE:"

      LS_SAL-SALIQUIDO = LS_SAL-SALBRUTO - LS_SAL-DEDUCOES + LS_SAL-BONUS + LV_YSDF.
      "SALÁRIO LÍQUIDO RECEBE O SALÁRIO BRUTO - DEDUÇÕES + BÔNUS + PARCELA SUBSÍDIO FÉRIAS E DÉCIMO TERCEIRO."

      APPEND LS_SAL TO LT_SAL. "INSERE A MINHA ESTRUTURA TOTALMENTE PREENCHIDA NA TABELA INTERNA."

      MODIFY ZRESTSAL FROM TABLE LT_SAL. "INSERE OS DADOS DA MINHA TABELA INTERNA À MINHA TABELA TRANSPARENTE."

    WHEN 'FCT_CONTRACHEQUE4'. "E QUANDO O BOTÃO CONTRACHEQUE FOR PRESSIONADO...

      "É SUMARIAMENTE IMPORTANTE MENCIONAR QUE PARA O USO DOS COMANDOS JOIN FOI NECESSÁRIO TRANSPORTAR A CHAVE PRIMÁRIA DA TABELA...
      "ZRESTSAL COMO CHAVE ESTRANGEIRA PARA A TABELA ZRESTEMPLOYEE...
      "ASSIM CONSEGUIMOS CONSOLIDAR A RELAÇÃO ENTRE ESTAS ENTIDADES."
      "LEMBRANDO QUE SE FAZ NECESSÁRIO CRIAR UM CAMPO NOVO NA TABELA A QUAL RECEBERÁ A CHAVE ESTRANGEIRA, E NÃO RELACIONAR DUAS CHAVES PRIMÁRIAS."

      SELECT ZRESTEMPLOYEE~FUNCIONARIO,               "SELECIONE A COLUNA FUNCIONÁRIO DA MINHA TABELA TRANSPARENTE ZRESTEMPLOYEE."
             ZRESTSAL~SALBRUTO,                       "SELECIONE A COLUNA SALBRUTO DA MINHA TABELA TRANSPARENTE ZRESTSAL."
             ZRESTSAL~SALIQUIDO,                      "SELECIONE A COLUNA PLANSAUDE DA MINHA TABELA TRANSPARENTE ZRESTSAL."
             ZRESTSAL~PLANSAUDE,                      "SELECIONE A COLUNA PLANSAUDE DA MINHA TABELA TRANSPARENTE ZRESTSAL."
             ZRESTSAL~CSINDICAL,                      "SELECIONE A COLUNA CSINDICAL DA MINHA TABELA TRANSPARENTE ZRESTSAL."
             ZRESTSAL~VALETRANS,                      "SELECIONE A COLUNA VALETRANS DA MINHA TABELA TRANSPARENTE ZRESTSAL."
             ZRESTSAL~HORAEXTRA,                      "SELECIONE A COLUNA HORAEXTRA DA MINHA TABELA TRANSPARENTE ZRESTSAL."
             ZRESTSAL~SEGSOCIAL,                      "SELECIONE A COLUNA SEGSOCIAL DA MINHA TABELA TRANSPARENTE ZRESTSAL."
             ZRESTSAL~IRS,                            "SELECIONE A COLUNA IRS DA MINHA TABELA TRANSPARENTE ZRESTSAL."
             ZRESTSAL~SUBDP                           "SELECIONE A COLUNA SUBDP DA MINHA TABELA TRANSPARENTE ZRESTSAL."
        INTO TABLE @DATA(LT_CONTRACHEQUE)             "INSIRA OS DADOS NA TABELA INTERNA RECÉM CRIADA LT_CONTRACHEQUE."
        FROM ZRESTEMPLOYEE                            "DA TABELA ZRESTEMPLOYEE."
        INNER JOIN ZRESTSAL ON                        "EM JUNÇÃO COM A TABELA ZRESTSAL."
        ZRESTEMPLOYEE~ID_SAL_FK = ZRESTSAL~ID         "EM QUE A AS DUAS TABELAS ESTÃO JUNTAS PELA CHAVE PRIMÁRIA E ESTRANGEIRA."
        ORDER BY ZRESTEMPLOYEE~FUNCIONARIO ASCENDING. "ORDENADAS POR FUNCIONÁRIOS EM ASCENDÊNCIA."

      TRY.                                                                  "TENTE
          CALL METHOD CL_SALV_TABLE=>FACTORY                                "CHAMADA DO MÉTODO DA CLASSE DE MANIPULAÇÃOO ALV PARA EXIBIR O RELATÓRIO."
            IMPORTING
              R_SALV_TABLE = REPORTALV                                      "A VARIÁVEL DE REFERÊNCIA À CLASSE CL_SALV_TABLE É IMPORTADA."
            CHANGING
              T_TABLE      = LT_CONTRACHEQUE.                               "MINHA TABELA INTERNA É ALTERADA COM A CLÁUSULA CHANGING DO MÉTODO."

          FUNCTIONS = REPORTALV->GET_FUNCTIONS( ).                          "OBTER AS FUNÇÕES DISPONÍVEIS PARA O RELATÓRIO ALV."
          FUNCTIONS->SET_ALL( ABAP_TRUE ).                                  "QUE TODAS AS FUNÇÕES ESTEJAM DISPONÍVEIS."

          CALL METHOD REPORTALV->DISPLAY( ).                                "CHAMADA DO MÉTODO PARA EXIBIR O RELATÓRIO ALV."
        CATCH CX_SALV_MSG.                                                  "CASO HAJA ALGUM PROBLEMA, SUBSTITUA O TRECHO ANTERIOR DO CÓDIGO POR...
          MESSAGE 'ERROR TO DISPLAY ALV REPORT!' TYPE 'S' DISPLAY LIKE 'I'. "...UMA MENSAGEM DE ERRO"
      ENDTRY.

    WHEN 'FCT_CONTRACHEQUEU4'.                     "E QUANDO O BOTÃO CONTRACHEQUEU FOR PRESSIONADO...
      IF IN1_4 > 0.                                "E SE O INPUT FOR MAIOR DO QUE ZERO...

       SELECT ZRESTEMPLOYEE~FUNCIONARIO,           "SELECIONE A COLUNA FUNCIONÁRIO DA MINHA TABELA TRANSPARENTE ZRESTEMPLOYEE."
              ZRESTSAL~SALBRUTO,                   "SELECIONE A COLUNA SALBRUTO DA MINHA TABELA TRANSPARENTE ZRESTSAL."
              ZRESTSAL~SALIQUIDO,                  "SELECIONE A COLUNA PLANSAUDE DA MINHA TABELA TRANSPARENTE ZRESTSAL."
              ZRESTSAL~PLANSAUDE,                  "SELECIONE A COLUNA PLANSAUDE DA MINHA TABELA TRANSPARENTE ZRESTSAL."
              ZRESTSAL~CSINDICAL,                  "SELECIONE A COLUNA CSINDICAL DA MINHA TABELA TRANSPARENTE ZRESTSAL."
              ZRESTSAL~VALETRANS,                  "SELECIONE A COLUNA VALETRANS DA MINHA TABELA TRANSPARENTE ZRESTSAL."
              ZRESTSAL~HORAEXTRA,                  "SELECIONE A COLUNA HORAEXTRA DA MINHA TABELA TRANSPARENTE ZRESTSAL."
              ZRESTSAL~SEGSOCIAL,                  "SELECIONE A COLUNA SEGSOCIAL DA MINHA TABELA TRANSPARENTE ZRESTSAL."
              ZRESTSAL~IRS,                        "SELECIONE A COLUNA IRS DA MINHA TABELA TRANSPARENTE ZRESTSAL."
              ZRESTSAL~SUBDP                       "SELECIONE A COLUNA SUBDP DA MINHA TABELA TRANSPARENTE ZRESTSAL."
          INTO TABLE @DATA(LT_CONTRACHEQUEU)       "INSIRA OS DADOS NA TABELA INTERNA RECÉM CRIADA LT_CONTRACHEQUEU."
          FROM ZRESTEMPLOYEE                       "DA TABELA ZRESTEMPLOYEE."
          INNER JOIN ZRESTSAL ON                   "EM JUNÇÃO COM A TABELA ZRESTSAL."
          ZRESTEMPLOYEE~ID_SAL_FK = ZRESTSAL~ID    "EM QUE A AS DUAS TABELAS ESTÃO JUNTAS PELA CHAVE PRIMÁRIA E ESTRANGEIRA."
          WHERE ZRESTEMPLOYEE~ID_GERENTE = @IN1_4. "ONDE O ID_GERENTE DA TABELA ZRESTEMPLOYEE SEJA IGUAL AO INPUT ID DA TELA."

        TRY.                                                                  "TENTE
            CALL METHOD CL_SALV_TABLE=>FACTORY                                "CHAMADA DO MÉTODO DA CLASSE DE MANIPULAÇÃOO ALV PARA EXIBIR O RELATÓRIO."
              IMPORTING
                R_SALV_TABLE = REPORTALV                                      "A VARIÁVEL DE REFERÊNCIA À CLASSE CL_SALV_TABLE É IMPORTADA."
              CHANGING
                T_TABLE      = LT_CONTRACHEQUEU.                              "MINHA TABELA INTERNA É ALTERADA COM A CLÁUSULA CHANGING DO MÉTODO."

            FUNCTIONS = REPORTALV->GET_FUNCTIONS( ).                          "OBTER AS FUNÇÕES DISPONÍVEIS PARA O RELATÓRIO ALV."
            FUNCTIONS->SET_ALL( ABAP_TRUE ).                                  "QUE TODAS AS FUNÇÕES ESTEJAM DISPONÍVEIS."

            CALL METHOD REPORTALV->DISPLAY( ).                                "CHAMADA DO MÉTODO PARA EXIBIR O RELATÓRIO ALV."
          CATCH CX_SALV_MSG.                                                  "CASO HAJA ALGUM PROBLEMA, SUBSTITUA O TRECHO ANTERIOR DO CÓDIGO POR...
            MESSAGE 'ERROR TO DISPLAY ALV REPORT!' TYPE 'S' DISPLAY LIKE 'I'. "...UMA MENSAGEM DE ERRO"
        ENDTRY.

      ELSE.                                                                    "DO CONTRÁRIO...
        MESSAGE 'INSIRA UM NÚMERO DE ID EXISTENTE!' TYPE 'S' DISPLAY LIKE 'I'. "EXIBIR ESTA MENSAGEM NO RODAPÉ DA TELA"
      ENDIF.
  ENDCASE.

ENDMODULE.

*&---------------------------------------------------------------------*
*& Module ANTES_EXCLUIR_FUNCIONARIO_0600 OUTPUT
*&---------------------------------------------------------------------*
*& "TELA DE EX-FUNCIONÁRIOS"
*&---------------------------------------------------------------------*
MODULE ANTES_EXCLUIR_FUNCIONARIO_0600 OUTPUT.
* SET PF-STATUS 'xxxxxxxx'.
* SET TITLEBAR 'xxx'.

  DATA IN1_6 TYPE ZIDGER. "ID"

ENDMODULE.

*&---------------------------------------------------------------------*
*&      Module  DEPOIS_EXCLUIR_FUNCIONARI_0600  INPUT
*&---------------------------------------------------------------------*
*  "TELA DE EX-FUNCIONÁRIOS"
*----------------------------------------------------------------------*
MODULE DEPOIS_EXCLUIR_FUNCIONARI_0600 INPUT.

  CASE OKCODE_600.       "EM CASO DE OKCODE_600...
    WHEN 'FCT_VOLTAR6'.  "E QUANDO O BOTÃO VOLTAR FOR PRESSIONADO...
      CALL SCREEN 200.   "IR PARA A TELA 200."
    WHEN 'FCT_SAIR6'.    "E QUANDO O BOTÃO SAIR FOR PRESSIONADO...
      LEAVE PROGRAM.     "SAIR DO PROGRAMA."
    WHEN 'FCT_EXCLUIR6'. "E QUANDO O BOTÃO EXCLUIR FOR PRESSIONADO...

      SELECT MANDT,                       "SELECIONE O CAMPO MANDANTE,
             ID_GERENTE,                  "ID_GERENTE,
             CARGO,                       "CARGO,
             FUNCIONARIO,                 "FUNCIONARIO,
             DATA_CONTRATACAO,            "DATA_CONTRATAÇÃO,
             ORDENADO FROM ZRESTEMPLOYEE  "E ORDENADO DA TABELA TRANSPARENTE ZRESTEMPLOYEE
             INTO TABLE @LT_EXC           "DENTRO DA TABELA INTERNA LT_EXC...
             WHERE ID_GERENTE = @IN1_6.   "ONDE O ID_GERENTE DA TABELA ZRESTEMPLOYEE FOR IGUAL AO INPUT ID DA TELA 600."

      MODIFY ZRESTEXC FROM TABLE LT_EXC.  "INSIRA OS DADOS DA TABELA INTERNA LT_EXC NA TABELA TRANSPARENTE ZRESTEXC."

      DELETE FROM ZRESTEMPLOYEE WHERE ID_GERENTE = IN1_6. "DELETE DA TABELA ZRESTEMPLOYEE ONDE O ID_GERENTE FOR IGUAL AO INPUT DA TELA 600."

      "ANTES DE EXCLUIR OS DADOS USANDO O COMANDO DELETE, TEMOS DE SER CUIDADOSOS EM MOVER ESTES MESMOS PARA A TABELA DE EX-FUNCIONÁRIOS."
      "A INTENÇÃO É GUARDAR ANTES DE EXCLUIR PARA TER UM BACKUP DA INFORMAÇÃO DESTES FUNCIONÁRIOS NO BANCO DE DADOS DA EMPRESA."

    WHEN 'FCT_EXIBIR6'. "E QUANDO O BOTÃO EXIBIR FOR PRESSIONADO...

      SELECT * FROM ZRESTEXC INTO TABLE LT_EXC. "SELECIONE TUDO DA TABELA TRANSPARENTE ZRESTEXC PARA A TABELA INTERNA LT_EXC.

      "AGORA PODEMOS USAR A TABELA DE EX-FUNCIONÁRIOS PARA SER EXIBIDA AO UTILIZADOR."

      TRY.                                                                  "TENTE
          CALL METHOD CL_SALV_TABLE=>FACTORY                                "CHAMADA DO MÉTODO DA CLASSE DE MANIPULAÇÃOO ALV PARA EXIBIR O RELATÓRIO."
            IMPORTING
              R_SALV_TABLE = REPORTALV                                      "A VARIÁVEL DE REFERÊNCIA À CLASSE CL_SALV_TABLE É IMPORTADA."
            CHANGING
              T_TABLE      = LT_EXC.                                        "MINHA TABELA INTERNA É ALTERADA COM A CLÁUSULA CHANGING DO MÉTODO."

          FUNCTIONS = REPORTALV->GET_FUNCTIONS( ).                          "OBTER AS FUNÇÕES DISPONÍVEIS PARA O RELATÓRIO ALV."
          FUNCTIONS->SET_ALL( ABAP_TRUE ).                                  "QUE TODAS AS FUNÇÕES ESTEJAM DISPONÍVEIS."

          CALL METHOD REPORTALV->DISPLAY( ).                                "CHAMADA DO MÉTODO PARA EXIBIR O RELATÓRIO ALV."
        CATCH CX_SALV_MSG.                                                  "CASO HAJA ALGUM PROBLEMA, SUBSTITUA O TRECHO ANTERIOR DO CÓDIGO POR...
          MESSAGE 'ERROR TO DISPLAY ALV REPORT!' TYPE 'S' DISPLAY LIKE 'I'. "...UMA MENSAGEM DE ERRO"
      ENDTRY.

  ENDCASE.

ENDMODULE.
