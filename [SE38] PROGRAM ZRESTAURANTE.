PROGRAM ZRESTAURANTE.

"----------------------------------------------------------------------

"                [TABELA TRANSPARENTE: ZRESTEMPLOYEE]                 "

"ID_GERENTE       TYPE ZIDGER CHAVE PRIMÁRIA    -> ID
"ID_SAL_FK        TYPE ZIDGER CHAVE ESTRANGEIRA -> ID_SALARIO
"CARGO            TYPE ZGERENTE                 -> CARGO
"FUNCIONARIO      TYPE ZFUNCIONARIO             -> NOME
"DATA_CONTRATACAO TYPE ZDATACONTR               -> DATA DA CONTRATAÇÃO
"TURNO            TYPE ZTURNO                   -> TURNO
"SEXO             TYPE ZSEXF                    -> SEXO
"IDADE            TYPE ZIDADEF                  -> IDADE
"ORDENADO         TYPE ZORDENADO                -> ORDENADO OU SALÁRIO
"PAGAMENTO        TYPE ZPAGAMENTO               -> STATUS DO PAGAMENTO

"----------------------------------------------------------------------

"----------------------------------------------------------------------

"                  [TABELA TRANSPARENTE: ZRESTSAL]                    "

"ID               TYPE ZIDGER CHAVE PRIMÁRIA -> ID
"SALBRUTO         TYPE ZSALBRUTO             -> SALÁRIO BRUTO
"SALIQUIDO        TYPE ZSALIQUIDO            -> SALÁRIO LÍQUIDO
"PLANSAUDE        TYPE ZPLANSAUDE            -> PLANO DE SAÚDE
"CSINDICAL        TYPE ZSINDICAL             -> CONTRIBUIÇÃO SINDICAL
"VALETRANS        TYPE ZVALETRANS            -> VALETRANSPORTE
"HORAEXTRA        TYPE ZHORAEXTRA            -> HORAS EXTRAS
"DEDUCOES         TYPE ZDEDUCOES             -> DEDUÇÕES SALARIAIS
"SEGOSOCIAL       TYPE ZSEGSOCIAL            -> SEGURANÇA SOCIAL
"IRS              TYPE ZIRS                  -> IRS
"BONUS            TYPE ZBONUS                -> BÔNUS SALARIAL
"SUBDECFER        TYPE ZSUBDECFER            -> SUBSÍDIO FÉRIAS & DÉCIMO
"SUBDP            TYPE ZSUBDP                -> SUBTRAÇÃO DE PRESENÇAS

"----------------------------------------------------------------------

TYPES: WA_EMP TYPE ZRESTEMPLOYEE,                 "ESTRUTURA GLOBAL DO TIPO DA MINHA TABELA TRANSPARENTE."
       WA_SAL TYPE ZRESTSAL.                      "ESTRUTURA GLOBAL DO TIPO DA MINHA TABELA TRANSPARENTE."

DATA: LS_EMP TYPE WA_EMP,                         "ESTRUTURA LOCAL DO TIPO DA MINHA ESTRUTURA GLOBAL."
      LS_SAL TYPE WA_SAL,                         "ESTRUTURA LOCAL DO TIPO DA MINHA ESTRUTURA GLOBAL."
      LT_EMP TYPE TABLE OF ZRESTEMPLOYEE,         "TABELA INTERNA DO TIPO DA MINHA TABELA TRANSPARENTE."
      LT_SAL TYPE TABLE OF ZRESTSAL.              "TABELA INTERNA DO TIPO DA MINHA TABELA TRANSPARENTE.

DATA: REPORTALV TYPE REF TO CL_SALV_TABLE,     "VARIÁVEL QUE FAZ REFERÊNCIA AO OBJETO DA CLASSE CL_SALV_TABLE."
      FUNCTIONS TYPE REF TO CL_SALV_FUNCTIONS. "VARIÁVEL QUE VAI ARMAZENAR A REFERÊNCIA AO OBJETO DA CLASSE CL_SALV_FUNCTIONS."

DATA: OKCODE_100 TYPE SY-UCOMM, "VARIÁVEL DO TIPO COMANDO DE FUNÇÃO DYNPRO PARA TELA 100."
      OKCODE_200 TYPE SY-UCOMM, "VARIÁVEL DO TIPO COMANDO DE FUNÇÃO DYNPRO PARA TELA 200."
      OKCODE_300 TYPE SY-UCOMM, "VARIÁVEL DO TIPO COMANDO DE FUNÇÃO DYNPRO PARA TELA 300."
      OKCODE_400 TYPE SY-UCOMM, "VARIÁVEL DO TIPO COMANDO DE FUNÇÃO DYNPRO PARA TELA 400."
      OKCODE_500 TYPE SY-UCOMM. "VARIÁVEL DO TIPO COMANDO DE FUNÇÃO DYNPRO PARA TELA 500."

"----------------------------------------------------------------------

*&---------------------------------------------------------------------*
*& Module ANTES_DO_LOGIN_0100 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE ANTES_DO_LOGIN_0100 OUTPUT.

* SET PF-STATUS 'xxxxxxxx'.
* SET TITLEBAR 'xxx'.

  DATA:
    IN1 TYPE C LENGTH 10, "LOGIN DO PROGRAMA NA TELA 100
    IN2 TYPE C LENGTH 10. "SENHA DO PROGRAMA NA TELA 100

ENDMODULE.

*&---------------------------------------------------------------------*
*&      Module  DEPOIS_DO_LOGIN_0100  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE DEPOIS_DO_LOGIN_0100 INPUT.

  CASE OKCODE_100.                         "EM CASO DE OKCODE_100...
    WHEN 'FCT_ENTRAR'.                     "E QUANDO O BOTÃO ENTRAR FOR PRESSIONADO...
      IF IN1 EQ 'ADMIN0' AND IN2 EQ '000'. "E SE O LOGIN FOR IGUAL A ADMIN0 JUNTAMENTE COM A SENHA IGUAL A 000...
        CALL SCREEN '200'.                 "IR PARA A TELA 100.
      ENDIF.
    WHEN 'FCT_SAIR'.                       "E QUANDO O BOTÃO SAIR FOR PRESSIONADO...
      LEAVE PROGRAM.                       "SAIR DO PROGRAMA.
  ENDCASE.

ENDMODULE.

*&---------------------------------------------------------------------*
*& Module ANTES_DE_SELECIONAR OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE ANTES_DE_SELECIONAR OUTPUT.
* SET PF-STATUS 'xxxxxxxx'.
* SET TITLEBAR 'xxx'.

ENDMODULE.


*&---------------------------------------------------------------------*
*&      Module  DEPOIS_DE_SELECIONAR  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE DEPOIS_DE_SELECIONAR INPUT.

  CASE OKCODE_200.         "EM CASO DE OKCODE_200...
    WHEN 'FCT_SAIR2'.      "E QUANDO O BOTÃO SAIR FOR PRESSIONADO...
      LEAVE PROGRAM.       "SAIR DO PROGRAMA."
    WHEN 'FCT_CADASTRAR2'. "E QUANDO O BOTÃO CADASTRAR FOR PRESSIONADO...
      CALL SCREEN '300'.   "IR PARA A TELA 300."
    WHEN 'FCT_PAGAR2'.     "E QUANDO O BOTÃO PAGAR FOR PRESSIONADO...
      CALL SCREEN '500'.   "IR PARA A TELA 500."
    WHEN 'FCT_CONSULTAR2'. "E QUANDO O BOTÃO CONSULTAR FOR PRESSIONADO...
      CALL SCREEN '400'.   "IR PARA A TELA 400."
  ENDCASE.

ENDMODULE.

*&---------------------------------------------------------------------*
*& Module ANTES_DO_CADASTRO_300 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE ANTES_DO_CADASTRO_300 OUTPUT.
* SET PF-STATUS 'xxxxxxxx'.
* SET TITLEBAR 'xxx'.

  "TODOS OS INPUTS DA TELA 300 RECEBEM O MESMO TIPO DE ELEMENTO DE DADOS DA MINHA TABELA TRANSPARENTE."

  DATA: IN0_3  TYPE ZIDGER,        "ID"
        IN1_3  TYPE ZGERENTE,      "CARGO"
        IN2_3  TYPE ZFUNCIONARIO,  "NOME"
        IN3_3  TYPE ZDATACONTR,    "DATA"
        IN31_3 TYPE ZTURNO,        "TURNO
        IN4_3  TYPE ZSEXF,         "SEXO"
        IN5_3  TYPE ZIDADEF,       "IDADE"
        IN6_3  TYPE ZORDENADO,     "ORDENADO"
        IN7_3  TYPE ZDESCR.        "OBSERVAÇÕES"

ENDMODULE.

*&---------------------------------------------------------------------*
*&      Module  DEPOIS_DE_CADASTRAR_300  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE DEPOIS_DE_CADASTRAR_300 INPUT.

  CASE OKCODE_300.         "EM CASO DE OKCODE_300...
    WHEN 'FCT_SAIR3'.      "E QUANDO O BOTÃO SAIR FOR PRESSIONADO...
      LEAVE PROGRAM.       "SAIR DO PROGRAMA.
    WHEN 'FCT_VOLTAR3'.    "E QUANDO O BOTÃO VOLTAR FOR PRESSIONADO...
      CALL SCREEN '200'.   "IR PARA A TELA 200.
    WHEN 'FCT_CADASTRAR3'. "E QUANDO O BOTÃO CADASTRAR FOR PRESSIONADO...

      "É FUNDAMENTAL USAR O ID_GERENTE NA INSERÇÃO DE DADOS ÀS TABELAS TRANSPARENTES...
      "...POIS O ID DIFERENTE FAZ COM QUE O COMANDO MODIFY NÃO INSIRA DADOS EM CIMA DA MESMA LINHA RECÉM CRIADA."

      LS_EMP-ID_GERENTE = IN0_3.       "ID DA MINHA ESTRUTURA RECEBE O ID DA TELA 300"
      LS_EMP-CARGO = IN1_3.            "CARGO DA MINHA ESTRUTURA RECEBE O CARGO DA TELA 300."
      LS_EMP-FUNCIONARIO = IN2_3.      "FUNCIONARIO DA MINHA ESTRUTURA RECEBE O FUNCIIONARIO DA TELA 300."
      LS_EMP-DATA_CONTRATACAO = IN3_3. "DATA DE CONTRATACAO DA MINHA ESTRUTURA RECEBE A DATA DA TELA 300."
      LS_EMP-TURNO = IN31_3.           "TURNO DE CONTRATAÇÃO DA MINHA ESTRUTURA RECEBE O TURNO DA TELA 300."
      LS_EMP-SEXO = IN4_3.             "SEXO DA MINHA ESTRUTURA RECEBE O SEXO DA TELA 300."
      LS_EMP-IDADE = IN5_3.            "IDADE DA MINHA ESTRUTURA RECEBE A IDADE DA TELA 300."
      LS_EMP-ORDENADO = IN6_3.         "ORDENADO DA MINHA ESTRUTURA RECEBE O ORDENADO DA TELA 300."

      "UPDATE ZRESTEMPLOYEE SET COLUMN = LT_COLUMN WHERE COLUMN_ID = *** "ESTA QUERY FICA AQUI CASO QUEIRA ALTERAR MINHA TABELA TRANSPARENTE.

      APPEND LS_EMP TO LT_EMP.                "INSERIR A MINHA ESTRUTURA NA MINHA TABELA INTERNA."
      MODIFY ZRESTEMPLOYEE FROM TABLE LT_EMP. "INSERIR O CONTEÚDO DA MINHA TABELA INTERNA PARA A TABELA TRANSPARENTE."

  ENDCASE.

ENDMODULE.

*&---------------------------------------------------------------------*
*& Module ANTES_DO_PAGAMENTO_500 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE ANTES_DO_PAGAMENTO_500 OUTPUT.
* SET PF-STATUS 'xxxxxxxx'.
* SET TITLEBAR 'xxx'.

  "O INPUT ID FUNCIONÁRIO DA TELA 500 RECEBE O MESMO TIPO DE ELEMENTO DE DADOS DA MINHA TABELA TRANSPARENTE."

  DATA: IN1_5 TYPE ZIDGER,     "ID"
        IN2_5 TYPE ZPAGAMENTO. "PAGAMENTO"

ENDMODULE.

*&---------------------------------------------------------------------*
*&      Module  DEPOIS_DO_PAGAMENTO_0500  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE DEPOIS_DO_PAGAMENTO_0500 INPUT.

  CASE OKCODE_500.       "EM CASO DE OKCODE_500...
    WHEN 'FCT_VOLTAR5'.  "E QUANDO O BOTÃO VOLTAR FOR PRESSIONADO...
      CALL SCREEN '200'. "IR PARA A TELA 200."
    WHEN 'FCT_SAIR5'.    "E QUANDO O BOTÃO SAIR FOR PRESSIONADO...
      LEAVE PROGRAM.     "SAIR DO PROGRAMA."
    WHEN 'FCT_DEFINIR5'. "E QUANDO O BOTÃO DEFINIR FOR PRESSIONADO...

      "PARA QUE O BOTÃO DEFINIR TENHA A SUA FUNCIONALIDADE, O CAMPO ID E A FORMA DE PAGAMENTO DEVEM ESTAR PREENCHIDOS."

      LS_EMP-ID_GERENTE = IN1_5. "ID DA MINHA ESTRUTURA RECEBE O ID DA TELA 500"
      LS_EMP-PAGAMENTO = IN2_5.  "PAGAMENTO DA MINHA ESTRUTURA RECEBE O PAGAMENTO DA TELA 500".

      APPEND LS_EMP TO LT_EMP. "INSIRA MINHA ESTRUTURA NA TABELA LOCAL"

      UPDATE ZRESTEMPLOYEE SET PAGAMENTO = LS_EMP-PAGAMENTO WHERE ID_GERENTE = IN1_5.
      "ATUALIZE A MINHA TABELA TRANSPARENTE SUBSTITUINDO A COLUNA PAGAMENTO PELO PAGAMENTO DE MINHA ESTRUTURA...
      "ONDE O ID DO GERENTE DE MINHA TABELA FOR IGUAL AO INPUT DA TELA 500."

    WHEN 'FCT_PAGOS5'. "E QUANDO O BOTÃO PAGOS FOR PRESSIONADO...

      SELECT FUNCIONARIO, PAGAMENTO FROM ZRESTEMPLOYEE INTO TABLE @DATA(LT_PAGOS) WHERE PAGAMENTO = 'OK'.

      "SELECIONE O CAMPO FUNCIONARIO E PAGAMENTO DA TABELA ZRESTEMPLOYEE E INSIRA NA TABELA LT_PAGOS ONDE PAGAMENTO RECEBE 'OK'."

      TRY.                                                                  "TENTE
          CALL METHOD CL_SALV_TABLE=>FACTORY                                "CHAMADA DO MÉTODO DA CLASSE DE MANIPULAÇÃOO ALV PARA EXIBIR O RELATÓRIO."
            IMPORTING
              R_SALV_TABLE = REPORTALV                                      "A VARIÁVEL DE REFERÊNCIA À CLASSE CL_SALV_TABLE É IMPORTADA."
            CHANGING
              T_TABLE      = LT_PAGOS.                                      "MINHA TABELA INTERNA É ALTERADA COM A CLÁUSULA CHANGING DO MÉTODO."

          FUNCTIONS = REPORTALV->GET_FUNCTIONS( ).                          "OBTER AS FUNÇÕES DISPONÍVEIS PARA O RELATÓRIO ALV."
          FUNCTIONS->SET_ALL( ABAP_TRUE ).                                  "QUE TODAS AS FUNÇÕES ESTEJAM DISPONÍVEIS."

          CALL METHOD REPORTALV->DISPLAY( ). "CHAMADA DO MÉTODO PARA EXIBIR O RELATÓRIO ALV."
        CATCH CX_SALV_MSG.                                                  "CASO HAJA ALGUM PROBLEMA, SUBSTITUA O TRECHO ANTERIOR DO CÓDIGO POR...
          MESSAGE 'ERROR TO DISPLAY ALV REPORT!' TYPE 'S' DISPLAY LIKE 'I'. "...UMA MENSAGEM DE ERRO"
      ENDTRY.

    WHEN 'FCT_NPAGOS5'.

      SELECT FUNCIONARIO, PAGAMENTO FROM ZRESTEMPLOYEE INTO TABLE @DATA(LT_NPAGOS) WHERE PAGAMENTO = 'PENDENTE'.

      "SELECIONE O CAMPO FUNCIONARIO E PAGAMENTO DA TABELA ZRESTEMPLOYEE E INSIRA NA TABELA LT_PAGOS ONDE PAGAMENTO RECEBE 'OK'."

      TRY.                                                                  "TENTE
          CALL METHOD CL_SALV_TABLE=>FACTORY                                "CHAMADA DO MÉTODO DA CLASSE DE MANIPULAÇÃOO ALV PARA EXIBIR O RELATÓRIO."
            IMPORTING
              R_SALV_TABLE = REPORTALV                                      "A VARIÁVEL DE REFERÊNCIA À CLASSE CL_SALV_TABLE É IMPORTADA."
            CHANGING
              T_TABLE      = LT_NPAGOS.                                     "MINHA TABELA INTERNA É ALTERADA COM A CLÁUSULA CHANGING DO MÉTODO."

          FUNCTIONS = REPORTALV->GET_FUNCTIONS( ).                          "OBTER AS FUNÇÕES DISPONÍVEIS PARA O RELATÓRIO ALV."
          FUNCTIONS->SET_ALL( ABAP_TRUE ).                                  "QUE TODAS AS FUNÇÕES ESTEJAM DISPONÍVEIS."

          CALL METHOD REPORTALV->DISPLAY( ). "CHAMADA DO MÉTODO PARA EXIBIR O RELATÓRIO ALV."
        CATCH CX_SALV_MSG.                                                  "CASO HAJA ALGUM PROBLEMA, SUBSTITUA O TRECHO ANTERIOR DO CÓDIGO POR...
          MESSAGE 'ERROR TO DISPLAY ALV REPORT!' TYPE 'S' DISPLAY LIKE 'I'. "...UMA MENSAGEM DE ERRO"
      ENDTRY.

  ENDCASE.

ENDMODULE.

*&---------------------------------------------------------------------*
*& Module ANTES_DA_CONSULTA_400 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE ANTES_DA_CONSULTA_400 OUTPUT.
* SET PF-STATUS 'xxxxxxxx'.
* SET TITLEBAR 'xxx'.

  DATA: IN1_4 TYPE ZIDGER,
        CB1_4 TYPE ZPLANSAUDE,
        CB2_4 TYPE ZSINDICAL,
        CB3_4 TYPE ZVALETRANS,
        IN2_4 TYPE ZHORAEXTRA,
        IN5_4 TYPE ZSUBDECFER,
        IN3_4 TYPE ZSUBDP,
        IN4_4 TYPE ZSUBDP.

ENDMODULE.

*&---------------------------------------------------------------------*
*&      Module  DEPOIS_DA_CONSULTA_400  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE DEPOIS_DA_CONSULTA_400 INPUT.

  CASE OKCODE_400.
    WHEN 'FCT_VOLTAR4'.
      CALL SCREEN '200'.
    WHEN 'FCT_SAIR4'.
      LEAVE PROGRAM.
    WHEN 'FCT_INSERIR4'.

      SELECT ORDENADO FROM ZRESTEMPLOYEE INTO TABLE @DATA(LT_ORDENADO) WHERE ID_GERENTE = @IN1_4.

      DATA: LV_ORDENADO TYPE ZORDENADO.

      LOOP AT LT_ORDENADO INTO DATA(LS_ORDENADO).
        LV_ORDENADO = LS_ORDENADO-ORDENADO.
      ENDLOOP.

      "--------------------------"
      "--------------------------"
      "    TURNO DE TRABALHO     "
      "--------------------------"
      "--------------------------"

      "VAMOS CUIDAR PARA QUE O TRABALHADOR NOTURNO RECEBA O SEU ADICIONAL NOTURNO"
      "E QUE SEJA INFORMADO TAMBÉM EM QUAL TURNO ELE TRABALHA."

      SELECT TURNO FROM ZRESTEMPLOYEE INTO TABLE @DATA(LT_TURNO) WHERE ID_GERENTE = @IN1_4.

      DATA: LV_TURNO TYPE ZTURNO.

      LOOP AT LT_TURNO INTO DATA(LS_TURNO).
        LV_TURNO = LS_TURNO-TURNO.
      ENDLOOP.

      IF LV_TURNO = 'NOTURNO'.                                   "SE O TURNO DO EMPREGADO FOR NOTURNO"
        LS_SAL-BONUS = LS_SAL-BONUS + ( '0.25' * LV_ORDENADO ).  "E A VARIÁVEL BÔNUS DE MINHA ESTRUTURA RECEBE MAIS 25% DO SALÁRIO BASE"
      ELSE.                                                      "DO CONTRÁRIO...
        LV_TURNO = 'DIURNO'.                                     "A VARIÁVEL DA MINHA ESTRUTURA RECEBE O NOME DIURNO"
      ENDIF.

      "--------------------------"
      "--------------------------"
      "      HORAS EXTRAS        "
      "--------------------------"
      "--------------------------"

      "AQUI VAMOS CALCULAR COMO O VALOR DAS HORAS EXTRAS VAI SE COMPORTAR DE ACORDO COM O TURNO TRABALHADO"

      DATA: LV_VALHRS TYPE P DECIMALS 2. "CRIA-SE UMA VARIÁVEL QUE IRÁ RECEBER O VALOR DA HORA"

      LV_VALHRS = LV_ORDENADO / ( 8 * 22 ).  "ESTA É UMA LÓGICA BÁSICA PARA SE CALCULAR QUANTO VALE A HORA EXTRA BASEADA NO SALÁRIO BASE DO EMPREGADO"
      "VALOR DA HORA = SALÁRIO BASE / ( 8 HORAS TRABALHADAS * 22 DIAS ÚTEIS DO MÊS).

      IF LV_TURNO = 'DIURNO'.                "SE FOR DURANTE O DIA...
        IN2_4 = IN2_4 * LV_VALHRS * 2.       "AS HORAS EXTRAS VALEM O DOBRO.
      ELSEIF LV_TURNO = 'NOTURNO'.           "SE FOR DURANTE A NOITE...
        IN2_4 = IN2_4 * LV_VALHRS * 3.       "AS HORAS EXTRAS VALEM O TRIPLO"
      ELSE.                                  "EM QUALQUER OUTRO CASO...
        IN2_4 = IN2_4 * LV_VALHRS * 1.       "ELAS VALEM O QUE SÃO."
      ENDIF.

      "PARA SE CALCULAR O VALOR TOTAL DAS HORAS EXTRAS A RECEBER...
      "TOTAL DE HORAS EXTRAS = TOTAL DE HORAS EXTRAS * VALOR DA HORA DO FUNCIONÁRIO * TURNO TRABALHADO."

      LS_SAL-HORAEXTRA = IN2_4.

      "DIZEMOS ENTÃO QUE O VALOR TOTAL DAS HORAS EXTRAS EM MINHA ESTRUTURA RECEBE O RESULTADO CALCULADO DO PARÂMETRO."

      LS_SAL-SALBRUTO = LV_ORDENADO + LS_SAL-HORAEXTRA.

      "APROVEITAMOS E DIZEMOS QUE O SALÁRIO BRUTO RECEBE O SALÁRIO BASE + O VALOR DAS HORAS EXTRAS."

      "--------------------------"
      "--------------------------"
      "   SUBSÍDIO E DÉCIMO      "
      "--------------------------"
      "--------------------------"

      DATA: LV_YSDF TYPE P DECIMALS 2. "É CRIADA UMA VARIÁVEL LOCAL PARA RECEBER O VALOR DO SUBSÍDIO"

      IF IN5_4 = 'MENSAL'.                                                   "SE OPTAR POR RECEBER O SUBSÍDIO MENSALMENTE...
        LV_YSDF = LV_YSDF + ( LS_SAL-SALBRUTO / 12 ) + ( LV_ORDENADO / 12 ). "A VARIÁVEL LOCAL RECEBE O SUBSÍDIO FÉRIAS + SUBSÍDIO DÉCIMO TERCEIRO"
      ELSE.                                                                  "DO CONTRÁRIO...
        LV_YSDF = 0.                                                         "A VARIÁVEL RECEBE ZERO.
      ENDIF.

      LS_SAL-SUBDECFER = LV_YSDF. "A VARIÁVEL DE MINHA ESTRUTURA RECEBE O VALOR DO PARÂMETRO"

      "--------------------------"
      "--------------------------"
      "       BENEFÍCIOS         "
      "--------------------------"
      "--------------------------"

      "DEPENDENDO DOS BENEFÍCIOS DE SERVIÇO QUE O TRABALHADOR OPTAR POR ESCOLHER, ESTES MESMOS SERÃO ACRESCENTADOS ÀS DEDUÇÕES SALARIAIS."

      IF CB1_4 = 'X'.                                                         "SE DECIDIR OPTAR POR UM PLANO DE SAÚDE PRIVADO...
        LS_SAL-PLANSAUDE = 'OK'.                                              "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR AUTORIZADO"
        LS_SAL-DEDUCOES = LS_SAL-DEDUCOES + ( ( 5 / 100 ) * LV_ORDENADO ).    "O PREÇO DO PRODUTO É ACRESCIDO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
      ELSE.                                                                   "DO CONTRÁRIO...
        LS_SAL-PLANSAUDE = 'NÃO'.                                             "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR NÃO AUTORIZADO"
      ENDIF.

      IF CB2_4 = 'X'.                                                         "SE DECIDIR OPTAR POR UMA CONTRIBUIÇÃO SINDICAL...
        LS_SAL-CSINDICAL = 'OK'.                                              "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR AUTORIZADO"
        LS_SAL-DEDUCOES = LS_SAL-DEDUCOES + 4.                                "O PREÇO DO PRODUTO É ACRESCIDO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
      ELSE.                                                                   "DO CONTRÁRIO...
        LS_SAL-CSINDICAL = 'NÃO'.                                             "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR NÃO AUTORIZADO"
      ENDIF.

      IF CB3_4 = 'X'.                                                         "SE DECIDIR OPTAR VALE TRANSPORTE...
        LS_SAL-VALETRANS = 'OK'.                                              "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR AUTORIZADO"
        LS_SAL-BONUS = LS_SAL-BONUS + '103.5'.                                "O PREÇO DO PRODUTO É ACRESCIDO À VARIÁVEL DE DEDUÇÕES SALARIAIS
      ELSE.                                                                   "DO CONTRÁRIO...
        LS_SAL-VALETRANS = 'NÃO'.                                             "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR NÃO AUTORIZADO"
      ENDIF.

      "DEPOIS DE TODOS OS SERVIÇOS OU NÃO, OS VALORES ESTARÃO SOMADOS E A VARIÁVEL LV_DEDUCT(DEDUÇÕES) RECEBERÁ ESTE VALOR.
      "OU A VARIÁVEL LV_BONUS RECEBERÁ UM ACRÉSCIMO EM SEU VALOR."

      "--------------------------"
      "--------------------------"
      "    SEGURANÇA SOCIAL      "
      "--------------------------"
      "--------------------------"

      IF LV_ORDENADO < 886.
        LS_SAL-DEDUCOES = LS_SAL-DEDUCOES + ( '0.11' * LV_ORDENADO ).
        LS_SAL-SEGSOCIAL = '0.11' * LV_ORDENADO.
      ENDIF.

      "--------------------------"
      "--------------------------"
      "        DESEMPENHO        "
      "--------------------------"
      "--------------------------"

      "CÁLCULO DE FALTAS E ATRASOS."

      DATA: LV_FALTAS TYPE ZSUBDP,
            LV_ATRASOS TYPE ZSUBDP.

      IF IN3_4 > 0.
        LV_FALTAS = IN3_4 * ( LV_ORDENADO / 22 ). "DIAS"
      ELSE.
        LV_FALTAS = 0.
      ENDIF.

      IF IN4_4 > 0.
        LV_ATRASOS = IN4_4 * ( LV_ORDENADO / 176 ). "ATRASOS"
      ELSE.
        LV_ATRASOS = 0.
      ENDIF.

      LS_SAL-SUBDP = LV_FALTAS + LV_ATRASOS.
      LS_SAL-DEDUCOES = LS_SAL-DEDUCOES + LS_SAL-SUBDP.

      "POR FIM, JÁ TEMOS TODOS OS VALORES E AS LÓGICAS POR DETRÁS DELES...MENOS UM.
      "NOSSO SALÁRIO LÍQUIDO, QUE É NOSSO SALÁRIO BRUTO MENOS TODAS AS DEDUÇÕES TRIBUTÁRIAS...
      "AS DEDUÇÕES TRIBUTÁRIAS SÓ PODERIAM SER CALCULADAS EM TOTALIDADE APÓS SABER QUANTO CADA EMPREGADOR TERÁ DE DECLARAR PARA A SEGURANÇA SOCIAL E QUANTIFICAR OS SERVIÇOS QUE O EMPREGADOR ADERIU."
      "SENDO ASSIM, PODEMOS ADMITIR QUE:"

      LS_SAL-SALIQUIDO = LS_SAL-SALBRUTO - LS_SAL-DEDUCOES + LS_SAL-BONUS + LS_SAL-SUBDP.

      APPEND LS_SAL TO LT_SAL.

      BREAK-POINT.

  ENDCASE.

ENDMODULE.
